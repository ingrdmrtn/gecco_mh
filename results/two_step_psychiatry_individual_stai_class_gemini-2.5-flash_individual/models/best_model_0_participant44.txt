class ParticipantModel1(CognitiveModelBase):
    """
    HYPOTHESIS: Anxiety-Modulated Initial Bias for Stage 1 (Default Preference)
    This model posits that the participant has a strong, anxiety-amplified
    initial preference or "default" choice for Stage 1, Action 0. High anxiety
    exaggerates this pre-existing bias, leading to minimal or no exploration
    of the alternative first-stage action. This explains the observed behavior
    of exclusively choosing Stage 1, Action 0.

    Parameter Bounds:
    -----------------
    alpha: [0, 1] - Learning rate for both stages.
    beta: [0, 10] - Softmax inverse temperature.
    bias_base: [0, 5] - Base constant bias added to Q-value of Action 0 at Stage 1.
    anxiety_bias_multiplier: [0, 5] - How much STAI score boosts this bias for Action 0.
    """

    def unpack_parameters(self, model_parameters: tuple) -> None:
        self.alpha, self.beta, self.bias_base, self.anxiety_bias_multiplier = model_parameters

    def init_model(self) -> None:
        # Calculate the effective bias for Action 0, ensuring it's non-negative
        self.effective_bias_action0 = max(0.0, self.bias_base + self.stai * self.anxiety_bias_multiplier)

    def policy_stage1(self) -> np.ndarray:
        """
        Compute stage-1 action probabilities by adding an anxiety-modulated
        bias to the Q-value of Action 0 before softmax.
        """
        q_values_biased = np.copy(self.q_stage1)
        q_values_biased[0] += self.effective_bias_action0
        
        return self.softmax(q_values_biased, self.beta)

    # The value_update method is inherited from the base class.

cognitive_model1 = make_cognitive_model(ParticipantModel1)