class ParticipantModel2(CognitiveModelBase):
    """
    HYPOTHESIS: High anxiety promotes cognitive rigidity, leading to a perseverative choice bias. The model adds a "stickiness" bonus to the value of the action chosen on the previous trial. The magnitude of this bonus is scaled by the STAI score.

    Parameter Bounds:
    -----------------
    alpha: [0, 1]
    beta: [0, 10]
    kappa: [0, 5]
    """

    def unpack_parameters(self, model_parameters: tuple) -> None:
        self.alpha, self.beta, self.kappa = model_parameters

    def policy_stage1(self) -> np.ndarray:
        """
        Computes stage-1 action probabilities with a perseveration bias.
        """
        q_biased = self.q_stage1.copy()
        
        # Add a perseveration bonus to the last chosen action
        if self.last_action1 is not None:
            # The perseveration bonus is the base parameter kappa scaled by anxiety
            perseveration_bonus = self.kappa * self.stai
            q_biased[self.last_action1] += perseveration_bonus
            
        return self.softmax(q_biased, self.beta)

cognitive_model2 = make_cognitive_model(ParticipantModel2)