class ParticipantModel2(CognitiveModelBase):
    """
    HYPOTHESIS: This model suggests that anxiety promotes choice perseveration,
    or a tendency to repeat the same action. This is a simple heuristic that can reduce
    cognitive load and the stress of making a new decision. The strength of this
    perseveration bias is directly proportional to the participant's STAI score.
    This could explain the participant's long streaks of choosing the same spaceship,
    particularly the extended period of choosing spaceship 1.

    Parameter Bounds:
    -----------------
    alpha: [0, 1]   (learning rate)
    beta: [0, 10]  (inverse temperature for choice stochasticity)
    pi: [0, 5]     (perseveration weight, scales the bias to repeat actions)
    """

    def unpack_parameters(self, model_parameters: tuple) -> None:
        self.alpha, self.beta, self.pi = model_parameters

    def policy_stage1(self) -> np.ndarray:
        """
        Computes stage-1 action probabilities with an added perseveration bias.
        """
        # Start with the learned Q-values
        q_stage1_biased = np.copy(self.q_stage1)

        # Add a bias to the value of the action that was chosen on the previous trial
        if self.trial > 0 and self.last_action1 is not None:
            # The bias strength is modulated by the perseveration parameter and STAI score
            bias = self.pi * self.stai
            q_stage1_biased[self.last_action1] += bias

        return self.softmax(q_stage1_biased, self.beta)

cognitive_model2 = make_cognitive_model(ParticipantModel2)