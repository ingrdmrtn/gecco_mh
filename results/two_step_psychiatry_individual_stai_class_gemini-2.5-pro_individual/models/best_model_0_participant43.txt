class ParticipantModel2(CognitiveModelBase):
    """
    HYPOTHESIS: Anxiety increases sensitivity to negative outcomes. This participant
    learns more from negative prediction errors (outcomes worse than expected) than
    from positive ones. The degree of this learning asymmetry is scaled by their
    STAI score.

    Parameter Bounds:
    -----------------
    alpha_base: [0, 1] (Base learning rate)
    beta: [0, 10]      (Choice temperature)
    neg_bias: [0, 5]   (Multiplier for learning from negative outcomes)
    """

    def unpack_parameters(self, model_parameters: tuple) -> None:
        self.alpha_base, self.beta, self.neg_bias = model_parameters

    def value_update(self, action_1: int, state: int, action_2: int, reward: float) -> None:
        """
        Updates Q-values using separate learning rates for positive and negative
        prediction errors, with the negative learning rate modulated by anxiety.
        """
        # Calculate the anxiety-modulated boost for negative PEs
        negative_lr_multiplier = 1 + self.neg_bias * self.stai

        # Asymmetric update for stage 2
        delta_2 = reward - self.q_stage2[state, action_2]
        alpha_2 = self.alpha_base
        if delta_2 < 0:
            alpha_2 *= negative_lr_multiplier
        self.q_stage2[state, action_2] += alpha_2 * delta_2

        # Asymmetric update for stage 1
        delta_1 = self.q_stage2[state, action_2] - self.q_stage1[action_1]
        alpha_1 = self.alpha_base
        if delta_1 < 0:
            alpha_1 *= negative_lr_multiplier
        self.q_stage1[action_1] += alpha_1 * delta_1

cognitive_model2 = make_cognitive_model(ParticipantModel2)