class ParticipantModel3(CognitiveModelBase):
    """
    HYPOTHESIS: High anxiety (`stai`) leads to a reduction in exploration by making
    the choice policy more deterministic. Anxiety amplifies the inverse temperature
    parameter (`beta`), causing the individual to more greedily exploit the option
    with the current highest value. Combined with a small intrinsic bias, this can
    cause the agent to "lock in" to a single choice early on and never explore the
    alternative.

    Parameter Bounds:
    -----------------
    alpha: [0, 1]      (Learning rate)
    beta: [0, 10]      (Base inverse temperature)
    bias: [-2, 2]      (Intrinsic preference for spaceship 0 vs 1)
    """

    def unpack_parameters(self, model_parameters: tuple) -> None:
        self.alpha, self.beta, self.bias = model_parameters

    def policy_stage1(self) -> np.ndarray:
        """
        Computes stage-1 policy where anxiety amplifies choice determinism.
        """
        q_values_biased = self.q_stage1.copy()
        q_values_biased[0] += self.bias

        # As stai -> 1, the denominator -> 0, making effective_beta very large.
        # This leads to highly deterministic choices (less exploration).
        # An epsilon is added for numerical stability if stai is exactly 1.
        effective_beta = self.beta / (1 - self.stai + 1e-6)
        
        return self.softmax(q_values_biased, effective_beta)

cognitive_model3 = make_cognitive_model(ParticipantModel3)