class ParticipantModel2(CognitiveModelBase):
    """
    [HYPOTHESIS: Anxiety-Driven Perseveration]
    This model hypothesizes that high anxiety increases "stickiness" or perseveration. 
    Anxious individuals may stick to their previous choice to reduce cognitive load 
    or avoid the uncertainty of switching, regardless of the reward value.
    The degree of stickiness is a base parameter plus an anxiety-dependent component.

    Parameter Bounds:
    -----------------
    alpha: [0, 1] - Learning rate.
    beta: [0, 10] - Inverse temperature.
    stickiness_factor: [0, 5] - How much the STAI score contributes to choice perseveration.
    """

    def unpack_parameters(self, model_parameters: tuple) -> None:
        self.alpha, self.beta, self.stickiness_factor = model_parameters

    def policy_stage1(self) -> np.ndarray:
        # Calculate stickiness bonus
        bonus = np.zeros(self.n_choices)
        if self.last_action1 is not None:
            # The bonus is proportional to anxiety
            # Higher STAI -> Higher bonus to repeat last action
            bonus[int(self.last_action1)] = self.stai * self.stickiness_factor
        
        # Combine Q-values with stickiness bonus
        combined_values = self.q_stage1 + bonus
        return self.softmax(combined_values, self.beta)

    # Standard value update from base class is sufficient (TD learning)

cognitive_model2 = make_cognitive_model(ParticipantModel2)