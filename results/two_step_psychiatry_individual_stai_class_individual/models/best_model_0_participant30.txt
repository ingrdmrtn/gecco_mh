class ParticipantModel2(CognitiveModelBase):
    """
    HYPOTHESIS: Anxiety drives choice stickiness (perseveration).
    
    Cognitive Theory:
    Anxious individuals often exhibit rigid behavior or "safety behaviors" to reduce 
    decision conflict and uncertainty. They are more likely to repeat their previous 
    choice regardless of the outcome, using repetition as a coping mechanism.
    
    Mechanism:
    A "stickiness bonus" is added to the Q-value of the previously chosen action 
    during the selection process. The magnitude of this bonus scales with the STAI score.
    
    bonus = stick_sensitivity * stai
    
    Parameter Bounds:
    -----------------
    alpha: [0, 1]
    beta: [0, 10]
    stick_sensitivity: [0, 5] # Scaling factor for anxiety-induced stickiness
    """

    def unpack_parameters(self, model_parameters: tuple) -> None:
        self.alpha, self.beta, self.stick_sensitivity = model_parameters

    def policy_stage1(self) -> np.ndarray:
        # Calculate anxiety-dependent stickiness bonus
        bonus_val = self.stick_sensitivity * self.stai
        
        # Create a temporary view of values to add bias without altering learned Q-values
        q_biased = self.q_stage1.copy()
        
        # Add bonus to the last chosen action if it exists (i.e., not the first trial)
        if self.last_action1 is not None:
            q_biased[int(self.last_action1)] += bonus_val
            
        return self.softmax(q_biased, self.beta)

cognitive_model2 = make_cognitive_model(ParticipantModel2)