class ParticipantModel2(CognitiveModelBase):
    """
    [HYPOTHESIS: Anxiety-Driven Perseveration]
    This model hypothesizes that the participant relies on a Model-Free strategy 
    but exhibits "stickiness" or perseveration (repeating the last choice) 
    driven by anxiety. The urge to repeat the previous action, regardless of 
    outcome, scales with the STAI score, representing a safety-seeking or 
    compulsive behavior often seen in high anxiety.

    Stickiness bonus = k_anx * stai
    
    Parameter Bounds:
    -----------------
    alpha: [0, 1]   (Learning rate)
    beta: [0, 10]   (Inverse temperature)
    k_anx: [0, 5]   (Anxiety-scaling factor for stickiness)
    """

    def unpack_parameters(self, model_parameters: tuple) -> None:
        self.alpha, self.beta, self.k_anx = model_parameters

    def policy_stage1(self) -> np.ndarray:
        q_values = self.q_stage1.copy()
        
        # Apply stickiness bonus if a previous action exists
        if self.last_action1 is not None:
            stickiness_bonus = self.k_anx * self.stai
            q_values[int(self.last_action1)] += stickiness_bonus
            
        return self.softmax(q_values, self.beta)

cognitive_model2 = make_cognitive_model(ParticipantModel2)