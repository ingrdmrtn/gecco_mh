class ParticipantModel3(CognitiveModelBase):
    """
    Hypothesis: Anxiety-Modulated Perseveration.
    
    This model hypothesizes that anxiety drives a "safety-seeking" behavior, 
    manifesting as a tendency to repeat the previous choice (perseveration) 
    regardless of the reward outcome. This is modeled as a choice "bonus" 
    added to the previously selected action, scaled by the STAI score.
    
    Q_net(a) = Q_learned(a) + (stai * p_scale) if a == last_action
    
    This participant's low anxiety suggests a lower tendency for anxiety-driven 
    perseveration compared to high-anxiety individuals, allowing their choices 
    to be driven more purely by value.

    Parameter Bounds:
    -----------------
    alpha: [0, 1]    - Learning rate
    beta: [0, 10]    - Inverse temperature
    p_scale: [0, 5]  - Scaling factor for anxiety-driven perseveration bonus
    """

    def unpack_parameters(self, model_parameters: tuple) -> None:
        self.alpha, self.beta, self.p_scale = model_parameters

    def policy_stage1(self) -> np.ndarray:
        # Start with learned values
        q_vals = self.q_stage1.copy()
        
        # Add anxiety-modulated perseveration bonus
        if self.last_action1 is not None:
            bonus = self.stai * self.p_scale
            q_vals[int(self.last_action1)] += bonus
            
        return self.softmax(q_vals, self.beta)

cognitive_model3 = make_cognitive_model(ParticipantModel3)