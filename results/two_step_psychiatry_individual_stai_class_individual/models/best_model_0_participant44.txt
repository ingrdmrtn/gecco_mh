class ParticipantModel1(CognitiveModelBase):
    """
    [HYPOTHESIS: Anxiety-Driven Habituation]
    Anxiety promotes reliance on habitual responses over value-based calculations.
    This model maintains a 'habit strength' trace for each stage-1 action, which
    accumulates simply by choosing the action (regardless of reward).
    
    The influence of this habit strength on choice is scaled by STAI.
    High anxiety -> Stronger tendency to repeat frequent choices (Habit).

    Parameter Bounds:
    -----------------
    alpha: [0, 1]        - Learning rate for both Value and Habit
    beta: [0, 10]        - Inverse temperature
    habit_weight: [0, 5] - Scaling factor for anxiety's effect on habit influence
    """

    def unpack_parameters(self, model_parameters: tuple) -> None:
        self.alpha, self.beta, self.habit_weight = model_parameters

    def init_model(self) -> None:
        # Initialize habit strength for the two stage-1 choices (A and U)
        self.habit = np.zeros(self.n_choices)

    def policy_stage1(self) -> np.ndarray:
        # Combine Value (Q) and Habit (H)
        # The weight of the habit component is modulated by anxiety (STAI)
        net_values = self.q_stage1 + (self.habit_weight * self.stai * self.habit)
        return self.softmax(net_values, self.beta)

    def post_trial(self, action_1: int, state: int, action_2: int, reward: float) -> None:
        super().post_trial(action_1, state, action_2, reward)
        
        # Update Habit trace: Strengthen chosen, weaken unchosen
        # We reuse self.alpha for the habit learning rate to minimize parameters
        self.habit[action_1] += self.alpha * (1 - self.habit[action_1])
        self.habit[1 - action_1] += self.alpha * (0 - self.habit[1 - action_1])

cognitive_model1 = make_cognitive_model(ParticipantModel1)