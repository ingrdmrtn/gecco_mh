class ParticipantModel2(CognitiveModelBase):
    """
    [HYPOTHESIS: Anxiety-Modulated Rare Event Suppression]
    This model hypothesizes that anxious individuals are intolerant of uncertainty 
    and "surprising" events. When a rare transition occurs (e.g., Spaceship A 
    going to Planet Y), the participant suppresses learning from this trial to 
    protect their internal model from outliers. The degree of learning rate 
    dampening on rare trials is proportional to their anxiety level.

    Parameter Bounds:
    -----------------
    alpha: [0, 1] (Base learning rate)
    beta: [0, 10] (Inverse temperature)
    suppress_k: [0, 10] (Strength of suppression for rare transitions)
    """

    def unpack_parameters(self, model_parameters: tuple) -> None:
        self.alpha, self.beta, self.suppress_k = model_parameters

    def value_update(self, action_1: int, state: int, action_2: int, reward: float) -> None:
        # Determine if the transition was Common or Rare
        # We assume the standard structure: 
        # Action 0 -> State 0 (Common), State 1 (Rare)
        # Action 1 -> State 1 (Common), State 0 (Rare)
        is_common = (action_1 == state)
        
        # Calculate effective learning rate
        if is_common:
            eff_alpha = self.alpha
        else:
            # Dampen learning rate for rare transitions based on anxiety
            # Higher anxiety -> stronger suppression (lower alpha)
            eff_alpha = self.alpha / (1.0 + self.suppress_k * self.stai)

        # Update Stage 2 (Standard)
        delta_2 = reward - self.q_stage2[state, action_2]
        self.q_stage2[state, action_2] += eff_alpha * delta_2
        
        # Update Stage 1 (Dampened if rare)
        delta_1 = self.q_stage2[state, action_2] - self.q_stage1[action_1]
        self.q_stage1[action_1] += eff_alpha * delta_1

cognitive_model2 = make_cognitive_model(ParticipantModel2)