class ParticipantModel3(CognitiveModelBase):
    """
    [HYPOTHESIS: Anxiety-Driven Perseveration]
    This model hypothesizes that anxiety drives a "safety behavior" or perseveration strategy,
    where the participant prefers to repeat their previous Stage 1 choice to reduce decision conflict
    or uncertainty. The strength of this "stickiness" is directly modulated by the STAI score.

    Parameter Bounds:
    -----------------
    alpha: [0, 1] (Learning rate)
    beta: [0, 10] (Inverse temperature)
    persev_param: [0, 5] (Base perseveration strength, scaled by STAI)
    """

    def unpack_parameters(self, model_parameters: tuple) -> None:
        self.alpha, self.beta, self.persev_param = model_parameters

    def policy_stage1(self) -> np.ndarray:
        # Start with learned Q-values
        logits = self.q_stage1.copy()
        
        # Add perseveration bonus if a previous action exists
        if self.last_action1 is not None:
            # The bonus is proportional to anxiety (STAI) * parameter
            bonus = self.stai * self.persev_param
            logits[int(self.last_action1)] += bonus
            
        return self.softmax(logits, self.beta)

cognitive_model3 = make_cognitive_model(ParticipantModel3)