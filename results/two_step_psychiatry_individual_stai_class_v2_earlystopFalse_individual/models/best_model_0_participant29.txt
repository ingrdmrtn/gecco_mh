class ParticipantModel2(CognitiveModelBase):
    """
    HYPOTHESIS: Anxiety-Driven Perseveration
    
    This model hypothesizes that high anxiety leads to "safety behaviors" manifested 
    as perseveration (stickiness). The participant is more likely to repeat their 
    previous stage-1 choice to avoid the uncertainty of switching.
    
    The degree of stickiness is directly proportional to the STAI score.
    Stickiness Bonus = stick_scale * stai
    
    Parameter Bounds:
    -----------------
    alpha: [0, 1]       (Learning rate)
    beta: [0, 10]       (Inverse temperature)
    stick_scale: [0, 5] (Scaling factor for anxiety-driven stickiness)
    """

    def unpack_parameters(self, model_parameters: tuple) -> None:
        self.alpha, self.beta, self.stick_scale = model_parameters

    def policy_stage1(self) -> np.ndarray:
        # Calculate stickiness bonus
        # If it's the first trial, last_action1 is None, so no bonus
        bonus = np.zeros(self.n_choices)
        
        if self.last_action1 is not None:
            # The bonus is applied to the action taken previously
            stickiness_magnitude = self.stick_scale * self.stai
            bonus[int(self.last_action1)] = stickiness_magnitude
            
        # Add bonus to Q-values before softmax
        # This effectively increases the probability of the repeated action
        augmented_values = self.q_stage1 + bonus
        
        return self.softmax(augmented_values, self.beta)

cognitive_model2 = make_cognitive_model(ParticipantModel2)