class ParticipantModel2(CognitiveModelBase):
    """
    HYPOTHESIS: Anxiety-Induced State Generalization.
    Anxious participants may over-generalize outcomes, updating beliefs about 
    unvisited states based on current experiences. If they receive a reward (or lack thereof) 
    on one planet, they update the value of the other planet in the same direction, 
    assuming a global environmental quality ("the world is good/bad today").
    
    Mechanism:
    Update visited state normally.
    Update unvisited state: Q(other) += alpha * (gen_rate * stai) * (reward - Q(other))
    
    Parameter Bounds:
    -----------------
    alpha: [0, 1]
    beta: [0, 10]
    gen_rate: [0, 1]
    """

    def unpack_parameters(self, model_parameters: tuple) -> None:
        self.alpha, self.beta, self.gen_rate = model_parameters

    def value_update(self, action_1: int, state: int, action_2: int, reward: float) -> None:
        # Standard update for the visited state
        delta_2 = reward - self.q_stage2[state, action_2]
        self.q_stage2[state, action_2] += self.alpha * delta_2
        
        # Generalization update for the unvisited state (other planet)
        # We apply the update to the same action index in the other state
        other_state = 1 - state
        gen_alpha = self.alpha * self.gen_rate * self.stai
        
        delta_gen = reward - self.q_stage2[other_state, action_2]
        self.q_stage2[other_state, action_2] += gen_alpha * delta_gen
        
        # Stage 1 update (standard)
        delta_1 = self.q_stage2[state, action_2] - self.q_stage1[action_1]
        self.q_stage1[action_1] += self.alpha * delta_1

cognitive_model2 = make_cognitive_model(ParticipantModel2)