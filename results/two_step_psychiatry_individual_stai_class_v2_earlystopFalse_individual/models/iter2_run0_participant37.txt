Here are three cognitive models that hypothesize different ways anxiety (STAI) modulates decision-making in the two-step task.

### Model 1: Anxiety-Modulated Loss Aversion
```python
class ParticipantModel1(CognitiveModelBase):
    """
    HYPOTHESIS: Anxiety increases sensitivity to negative outcomes (Loss Aversion).
    High anxiety participants may react more strongly to the omission of rewards (0 coins),
    updating their value estimates more aggressively after a loss than after a win.
    
    Mechanism:
    We use separate learning rates for positive (reward=1) and negative (reward=0) outcomes.
    The learning rate for losses is boosted by the STAI score.
    
    Parameter Bounds:
    -----------------
    alpha: [0, 1]          # Base learning rate (applied to wins)
    beta: [0, 10]          # Inverse temperature
    loss_sens: [0, 5]      # Sensitivity factor: alpha_loss = alpha * (1 + loss_sens * stai)
    """

    def unpack_parameters(self, model_parameters: tuple) -> None:
        self.alpha, self.beta, self.loss_sens = model_parameters

    def value_update(self, action_1: int, state: int, action_2: int, reward: float) -> None:
        # Determine effective learning rate based on outcome
        if reward == 0:
            # Boost learning rate for losses based on anxiety
            # We clip at 1.0 to ensure mathematical stability
            alpha_eff = min(1.0, self.alpha * (1.0 + self.loss_sens * self.stai))
        else:
            # Standard learning rate for wins
            alpha_eff = self.alpha
            
        # Stage 2 Update (TD learning)
        delta_2 = reward - self.q_stage2[state, action_2]
        self.q_stage2[state, action_2] += alpha_eff * delta_2
        
        # Stage 1 Update (TD learning)
        delta_1 = self.q_stage2[state, action_2] - self.q_stage1[action_1]
        self.q_stage1[action_1] += alpha_eff * delta_1

cognitive_model1 = make_cognitive_model(ParticipantModel1)
```

### Model 2: Anxiety-Impaired Model-Based Control
```python
class ParticipantModel2(CognitiveModelBase):
    """
    HYPOTHESIS: Anxiety impairs Model-Based (Goal-Directed) control.
    High anxiety consumes cognitive resources (e.g., working memory), forcing participants 
    to rely more on Model-Free (habitual) strategies rather than planning based on 
    the task's transition structure.
    
    Mechanism:
    We implement a Hybrid MB/MF model. The mixing weight 'w' (0=MF, 1=MB)
    is negatively modulated by STAI. Higher anxiety -> Lower w (More MF).
    
    Parameter Bounds:
    -----------------
    alpha: [0, 1]       # Learning rate for Model-Free values
    beta: [0, 10]       # Inverse temperature
    w_deficit: [0, 2]   # Anxiety impact: w = max(0, 1 - w_deficit * stai)
    """

    def unpack_parameters(self, model_parameters: tuple) -> None:
        self.alpha, self.beta, self.w_deficit = model_parameters

    def init_model(self) -> None:
        # Calculate mixing weight w based on anxiety
        # We assume a baseline of full MB capability (w=1) which is degraded by anxiety.
        self.w = max(0.0, 1.0 - self.w_deficit * self.stai)
        
        # Fixed transition matrix for Model-Based calculation
        # Action 0 -> State 0 (70%), State 1 (30%)
        # Action 1 -> State 0 (30%), State 1 (70%)
        self.T_fixed = np.array([[0.7, 0.3], [0.3, 0.7]])

    def policy_stage1(self) -> np.ndarray:
        # 1. Calculate Model-Based Values (Planning)
        # Q_MB(a) = Sum_s' T(s'|a) * max_a' Q2(s', a')
        q_mb = np.zeros(self.n_choices)
        for a in range(self.n_choices):
            probs = self.T_fixed[a] 
            max_q2 = np.max(self.q_stage2, axis=1) # Max value of next states
            q_mb[a] = np.dot(probs, max_q2)
            
        # 2. Retrieve Model-Free Values (Habit)
        # self.q_stage1 is updated via TD in value_update, representing MF values
        q_mf = self.q_stage1
        
        # 3. Combine MB and MF values
        q_net = self.w * q_mb + (1.0 - self.w) * q_mf
        
        return self.softmax(q_net, self.beta)

cognitive_model2 = make_cognitive_model(ParticipantModel2)
```

### Model 3: Anxiety-Induced Decision Noise
```python
class ParticipantModel3(CognitiveModelBase):
    """
    HYPOTHESIS: Anxiety increases decision noise (Exploration/Randomness).
    Anxious participants may experience interfering thoughts or difficulty concentrating,
    leading to less deterministic choices (lower inverse temperature beta) regardless of value.
    
    Mechanism:
    The softmax beta parameter is scaled down by STAI.
    beta_effective = beta_base / (1 + noise_scale * stai)
    
    Parameter Bounds:
    -----------------
    alpha: [0, 1]        # Learning rate
    beta_base: [0, 10]   # Baseline inverse temperature (for low anxiety)
    noise_scale: [0, 10] # Scaling factor for anxiety-induced noise
    """

    def unpack_parameters(self, model_parameters: tuple) -> None:
        self.alpha, self.beta_base, self.noise_scale = model_parameters

    def init_model(self) -> None:
        # Adjust beta based on anxiety
        # Higher anxiety -> Higher denominator -> Lower beta -> More random choices
        self.beta = self.beta_base / (1.0 + self.noise_scale * self.stai)

    # No other overrides needed; self.beta is used by the default policy methods.

cognitive_model3 = make_cognitive_model(ParticipantModel3)
```